<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inventario</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css">
  <link rel="stylesheet" href="css/inventario.css">
</head>
<body>
    <header>
        <%- include('nav'); %>
    </header>

    <!-- SecciÃ³n para crear producto -->
    <div class="container espacio">
      <h1>Crear Producto</h1>
      <form action="/CrearProducto" method="POST" enctype="multipart/form-data" class="form">
        <input type="text" name="Producto" placeholder="Nombre del producto" required>

        <select name="Tipo" class="form-select" required onchange="showFields()">
          <option value="">Categoria</option>
          <option value="Correa">Correa</option>
          <option value="Bolso">Bolso</option>
        </select>

        <input type="number" name="Precio" placeholder="Precio del producto" required>

        <div id="correas-section" style="display: none;">
          <label>Cantidad por talla</label>
          <div class="tallas-container">
            <% [30, 32, 34, 36, 38, 40, 42, 44, 46].forEach(talla => { %>
              <div class="talla-item">
                <p><%= talla %></p>
                <input type="number" name="Cantidad<%= talla %>" min="0" value="0">
              </div>
            <% }); %>
          </div>
        </div>

        <div id="bolso-section" style="display: none;">
          <label for="CantidadBolso">Cantidad</label>
          <input type="number" name="CantidadBolso" min="0" value="0">
        </div>

        <input type="file" name="Imagen" accept="image/*" required>
        <button type="submit">Crear</button>
      </form>
    </div>

    <!-- Inventario de Correas -->
    <div class="container">
      <h1>Inventario de Correas</h1>
      <table id="inventarioCorreas" class="table table-bordered text-center">
        <thead>
          <tr>
            <th>Imagen</th>
            <th>Nombre</th>
            <th>30</th>
            <th>32</th>
            <th>34</th>
            <th>36</th>
            <th>38</th>
            <th>40</th>
            <th>42</th>
            <th>44</th>
            <th>46</th>
            <th>Cantidad Total</th>
            <th>Opciones</th>
          </tr>
        </thead>
        <tbody>
          <% Productos.filter(p => p.Tipo === 'Correa').forEach(producto => { %>
            <tr>
              <td><img src="../img/Productos/<%= producto.Imagen %>" width="80px" alt=""></td>
              <td><%= producto.Producto %></td>
              <% [producto.T30, producto.T32, producto.T34, producto.T36, producto.T38, producto.T40, producto.T42, producto.T44, producto.T46].forEach(t => { %>
                <td><%= t %></td>
              <% }); %>
              <td><%= producto.Cantidad %></td>
              <td>
                <a href="/EliminarProducto/<%= producto.id %>" class="btn btn-outline-danger bi bi-trash3"></a>
                <button class="btnModal btn btn-outline-primary bi bi-pencil-square" id="Correa"></button>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>

    <!-- Inventario de Bolsos -->
    <div class="container">
      <h1>Inventario de Bolsos</h1>
      <table id="inventarioBolsos" class="table table-bordered text-center">
        <thead>
          <tr>
            <th>Imagen</th>
            <th>Nombre</th>
            <th>Cantidad</th>
            <th>Opciones</th>
          </tr>
        </thead>
        <tbody>
          <% Productos.filter(p => p.Tipo === 'Bolso').forEach(producto => { %>
            <tr>
              <td><img src="../img/Productos/<%= producto.Imagen %>" width="80px" alt=""></td>
              <td><%= producto.Producto %></td>
              <td><%= producto.Cantidad %></td>
              <td>
                <a href="/EliminarProducto/<%= producto.id %>" class="btn btn-outline-danger bi bi-trash3"></a>
                <button class="btnModal btn btn-outline-primary bi bi-pencil-square" id="Bolso"></button>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>

    <!-- Modal para editar Correas -->
    <div id="modalActualizarCorrea" class="modal fade" tabindex="-1" aria-labelledby="modalActualizarCorreaLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header bg-primary text-white">
            <h5 class="modal-title">Actualizar Correa</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form action="/EditarCorrea" method="POST">
              <input type="text" name="MProducto" id="MProducto" placeholder="Nombre del producto" required>
              <label for="cantidadPorTalla">Cantidad por talla</label>
              <div class="tallas-container">
                <% [30, 32, 34, 36, 38, 40, 42, 44, 46].forEach(t => { %>
                  <div class="talla-item">
                    <p><%= t %></p>
                    <input type="number" name="MCantidad<%= t %>" min="0" value="0">
                  </div>
                <% }); %>
              </div>
              <input type="number" name="MPrecio" id="MPrecio" placeholder="Precio" min="0" step="0.01" required>
              <button type="submit" class="btn btn-primary mt-3">Actualizar</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal para editar Bolsos -->
    <div id="modalActualizarBolso" class="modal fade" tabindex="-1" aria-labelledby="modalActualizarBolsoLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header bg-primary text-white">
            <h5 class="modal-title">Actualizar Bolso</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form action="/EditarBolso" method="POST">
              <input type="text" name="MProducto" id="MProducto" placeholder="Nombre del producto" required>
              <input type="number" name="MCantidad" id="MCantidad" placeholder="Cantidad" min="0" required>
              <input type="number" name="MPrecio" id="MPrecio" placeholder="Precio" min="0" step="0.01" required>
              <button type="submit" class="btn btn-primary mt-3">Actualizar</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
    <script src="js/Modal.js"></script>
    <script>
      $(document).ready(function() {
        $('#inventarioCorreas, #inventarioBolsos').DataTable({
          "language": { "url": "//cdn.datatables.net/plug-ins/1.13.5/i18n/es-ES.json" },
          "lengthChange": false,
          "pageLength": 5
        });
      });

      function showFields() {
        const tipo = document.querySelector('[name="Tipo"]').value;
        document.getElementById('correas-section').style.display = tipo === 'Correa' ? 'block' : 'none';
        document.getElementById('bolso-section').style.display = tipo === 'Bolso' ? 'block' : 'none';
      }
    </script>
</body>
</html>
